<section aria-labelledby="reset-heading" class="reset-card" role="region">
  <h1 id="reset-heading" class="reset-heading">Reset Your UMN Password</h1>

  <!-- success banner -->
  <div *ngIf="successMessage() as message"
       #successBannerRef
       class="reset-banner reset-banner--success"
       role="status"
       aria-live="polite"
       tabindex="-1">
    {{ message }}
  </div>

  <!-- error summary -->
  <div *ngIf="shouldShowErrorSummary()"
       #errorSummaryRef
       id="error-summary"
       class="reset-banner reset-banner--error"
       tabindex="-1"
       role="alert"
       aria-live="assertive">
    <h2 class="font-semibold text-red-700">Thereâ€™s a problem</h2>
    <ul *ngIf="validationMessages().length"
        class="reset-errors">
      <li *ngFor="let item of validationMessages()">
        <a class="underline"
           [href]="'#' + item.fieldId"
           (click)="focusField(item.fieldId); $event.preventDefault()">
          {{ item.message }}
        </a>
      </li>
    </ul>
    <p *ngIf="apiError()" class="text-red-700 mt-2">
      {{ apiError() }}
    </p>
  </div>

  <!-- form -->
  <form [formGroup]="form" (ngSubmit)="submit()" class="reset-form" novalidate>
    <!-- current password -->
    <div class="reset-fieldset">
      <label for="currentPassword" class="reset-label">Current Password</label>
      <div class="reset-input-wrapper">
        <input
          [type]="showCurrent ? 'text' : 'password'"
          id="currentPassword"
          formControlName="currentPassword"
          class="reset-field"
          autocomplete="current-password"
          [attr.aria-invalid]="hasControlError('currentPassword') ? 'true' : null"
          [attr.aria-describedby]="describeField('currentPassword', 'currentPassword-help')"
        />
        <button
          type="button"
          (click)="showCurrent = !showCurrent"
          class="reset-toggle"
          [attr.aria-pressed]="showCurrent">
          {{ showCurrent ? 'Hide' : 'Show' }}
        </button>
      </div>
      <p id="currentPassword-help" class="reset-help">
        Enter your existing UMN password.
      </p>
      <p *ngIf="getErrorMessage('currentPassword') as message"
         id="currentPassword-error"
         class="reset-help reset-help--error"
         aria-live="polite">
        {{ message }}
      </p>
    </div>

    <!-- new password -->
    <div class="reset-fieldset">
      <label for="newPassword" class="reset-label">New Password</label>
      <div class="reset-input-wrapper">
        <input
          [type]="showNew ? 'text' : 'password'"
          id="newPassword"
          formControlName="newPassword"
          class="reset-field"
          autocomplete="new-password"
          [attr.aria-invalid]="hasControlError('newPassword') ? 'true' : null"
          [attr.aria-describedby]="describeField('newPassword', 'newPassword-help')"
        />
        <button
          type="button"
          (click)="showNew = !showNew"
          class="reset-toggle"
          [attr.aria-pressed]="showNew">
          {{ showNew ? 'Hide' : 'Show' }}
        </button>
      </div>
      <p id="newPassword-help" class="reset-help">
        Must be at least 12 characters. Avoid common words or personal info.
      </p>
      <p *ngIf="getErrorMessage('newPassword') as message"
         id="newPassword-error"
         class="reset-help reset-help--error"
         aria-live="polite">
        {{ message }}
      </p>
    </div>

    <!-- confirm password -->
    <div class="reset-fieldset">
      <label for="confirmPassword" class="reset-label">Confirm New Password</label>
      <div class="reset-input-wrapper">
        <input
          [type]="showConfirm ? 'text' : 'password'"
          id="confirmPassword"
          formControlName="confirmPassword"
          class="reset-field"
          autocomplete="new-password"
          [attr.aria-invalid]="hasControlError('confirmPassword') ? 'true' : null"
          [attr.aria-describedby]="describeField('confirmPassword', 'confirmPassword-help')"
        />
        <button
          type="button"
          (click)="showConfirm = !showConfirm"
          class="reset-toggle"
          [attr.aria-pressed]="showConfirm">
          {{ showConfirm ? 'Hide' : 'Show' }}
        </button>
      </div>
      <p id="confirmPassword-help" class="reset-help">
        Re-enter the new password to confirm it.
      </p>
      <p *ngIf="getErrorMessage('confirmPassword') as message"
         id="confirmPassword-error"
         class="reset-help reset-help--error"
         aria-live="polite">
        {{ message }}
      </p>
    </div>

    <!-- submit button -->
    <button type="submit" class="reset-submit">
      Submit
    </button>
  </form>
</section>
